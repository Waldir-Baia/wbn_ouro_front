<form class="piece-form" [formGroup]="form" (ngSubmit)="submit()">
  <section class="form-grid">
    <label>
      Código interno
      <input type="text" formControlName="code" placeholder="PC-0001" />
    </label>
    <label>
      Nome da peça
      <input type="text" formControlName="name" placeholder="Anel Solitário" />
    </label>
    <label>
      Categoria
      <select formControlName="categoryId">
        <option [ngValue]="null">Selecione uma categoria</option>
        @for (category of categories; track category.id) {
          <option [ngValue]="category.id">
            {{ category.id }} - {{ category.nome }}
          </option>
        }
      </select>
    </label>
    <label>
      Tabela Preço
      <select formControlName="priceTableId">
        <option [ngValue]="null">Selecione uma tabela</option>
        @for (table of priceTables; track table.id) {
          <option [ngValue]="table.id">
            {{ table.id }} - {{ table.nome }}
          </option>
        }
      </select>
    </label>
    <label>
      Matéria-prima
      <select formControlName="rawMaterialId">
        <option [ngValue]="null">Selecione uma matéria-prima</option>
        @for (material of materials; track material.id) {
          <option [ngValue]="material.id">
            {{ material.id }} - {{ material.nome }}
          </option>
        }
      </select>
    </label>
    <label>
      Pedra principal
      <input type="text" formControlName="stone" placeholder="Diamante" />
    </label>
    <label>
      Prazo produção (dias)
      <input type="number" formControlName="productionTime" placeholder="7" />
    </label>
    <label>
      Situação do estoque
      <select formControlName="stock">
        <option [ngValue]="stockStatusEnum.Disponivel">Disponível</option>
        <option [ngValue]="stockStatusEnum.SobDemanda">Sob demanda</option>
        <option [ngValue]="stockStatusEnum.Indisponivel">Indisponível</option>
      </select>
    </label>
    <label class="full">
      Observações
      <textarea rows="3" formControlName="notes" placeholder="Detalhes técnicos"></textarea>
    </label>
  </section>

  <div class="form-actions">
    <button type="submit" [disabled]="loading">
      <span class="spinner" *ngIf="loading" aria-hidden="true"></span>
      {{ mode === 'edit' ? 'Salvar alterações' : 'Salvar peça' }}
    </button>
    <button type="button" class="ghost" (click)="handleCancel()" [disabled]="loading">Cancelar</button>
  </div>
</form>
