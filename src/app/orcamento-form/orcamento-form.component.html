<form class="orcamento-form" [formGroup]="form" (ngSubmit)="submit()">
  <section class="form-grid">
    <label>
      Número do orçamento
      <input type="text" formControlName="number" placeholder="ORC-2025-001" />
    </label>
    <label>
      Cliente
      <select formControlName="clientId">
        <option [ngValue]="null">Selecione um cliente</option>
        @for (client of clients; track client.id) {
          <option [ngValue]="client.id">
            {{ client.id }} - {{ client.nomeCompleto || client.nome || '-' }}
          </option>
        }
      </select>
    </label>
    <label>
      Serviço
      <select formControlName="serviceId">
        <option [ngValue]="null">Selecione um serviço</option>
        @for (service of services; track service.id) {
          <option [ngValue]="service.id">
            {{ service.id }} - {{ service.nome }}
          </option>
        }
      </select>
    </label>
    <label>
      Produto (opcional)
      <select formControlName="productId">
        <option [ngValue]="null">Sem produto</option>
        @for (product of products; track product.id) {
          <option [ngValue]="product.id">
            {{ product.id }} - {{ product.nome }}
          </option>
        }
      </select>
    </label>
    <label>
      Peso em gramas (opcional)
      <input type="number" step="0.001" formControlName="weightGrams" placeholder="3.500" />
    </label>
    <label>
      Data de emissão
      <input type="date" formControlName="issueDate" />
    </label>
    <label>
      Validade
      <input type="date" formControlName="validUntil" />
    </label>
    <label>
      Valor total (R$)
      <input type="number" step="0.01" formControlName="totalValue" placeholder="Calculado automaticamente" readonly />
      <small *ngIf="calculatingCost">Calculando custo...</small>
    </label>
    <label>
      Status
      <select formControlName="status">
        <option [ngValue]="statusEnum.EmAberto">Em aberto</option>
        <option [ngValue]="statusEnum.Aprovado">Aprovado</option>
        <option [ngValue]="statusEnum.Rejeitado">Rejeitado</option>
        <option [ngValue]="statusEnum.Expirado">Expirado</option>
      </select>
    </label>
    <label class="full">
      Descrição
      <textarea rows="3" formControlName="description" placeholder="Detalhes do orçamento"></textarea>
    </label>
    <label class="full">
      Observações
      <textarea rows="2" formControlName="notes" placeholder="Informações adicionais"></textarea>
    </label>
  </section>

  <div class="form-actions">
    <button type="submit" [disabled]="loading">
      <span class="spinner" *ngIf="loading" aria-hidden="true"></span>
      {{ mode === 'edit' ? 'Salvar alterações' : 'Salvar orçamento' }}
    </button>
    <button type="button" class="ghost" (click)="handleCancel()" [disabled]="loading">Cancelar</button>
  </div>
</form>
